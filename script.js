const keysArr = [[
  {
    ENG: '`',
    RUS: 'ё',
    code: 'Backquote',
  },
  {
    ENG: '1',
    RUS: '1',
    code: 'Digit1',
  },
  {
    ENG: '2',
    RUS: '2',
    code: 'Digit2',
  },
  {
    ENG: '3',
    RUS: '3',
    code: 'Digit3',
  },
  {
    ENG: '4',
    RUS: '4',
    code: 'Digit4',
  },
  {
    ENG: '5',
    RUS: '5',
    code: 'Digit5',
  },
  {
    ENG: '6',
    RUS: '6',
    code: 'Digit6',
  },
  {
    ENG: '7',
    RUS: '7',
    code: 'Digit7',
  },
  {
    ENG: '8',
    RUS: '8',
    code: 'Digit8',
  },
  {
    ENG: '9',
    RUS: '9',
    code: 'Digit9',
  },
  {
    ENG: '0',
    RUS: '0',
    code: 'Digit0',
  },
  {
    ENG: '-',
    RUS: '-',
    code: 'Minus',
  },
  {
    ENG: '=',
    RUS: '=',
    code: 'Equal',
  },
  {
    ENG: 'Backspace',
    RUS: 'Backspace',
    code: 'Backspace',
  }],
[
  {
    ENG: 'Tab',
    RUS: 'Tab',
    code: 'Tab',
  },
  {
    ENG: 'q',
    RUS: 'й',
    code: 'KeyQ',
  },
  {
    ENG: 'w',
    RUS: 'ц',
    code: 'KeyW',
  },
  {
    ENG: 'e',
    RUS: 'у',
    code: 'KeyE',
  },
  {
    ENG: 'r',
    RUS: 'к',
    code: 'KeyR',
  },
  {
    ENG: 't',
    RUS: 'е',
    code: 'KeyT',
  },
  {
    ENG: 'y',
    RUS: 'н',
    code: 'KeyY',
  },
  {
    ENG: 'u',
    RUS: 'г',
    code: 'KeyU',
  },
  {
    ENG: 'i',
    RUS: 'ш',
    code: 'KeyI',
  },
  {
    ENG: 'o',
    RUS: 'щ',
    code: 'KeyO',
  },
  {
    ENG: 'p',
    RUS: 'з',
    code: 'KeyP',
  },
  {
    ENG: '[',
    RUS: 'х',
    code: 'BracketLeft',
  },
  {
    ENG: ']',
    RUS: 'ъ',
    code: 'BracketRight',
  },
  {
    ENG: '\\',
    RUS: '\\',
    code: 'Backslash',
  }],
[
  {
    ENG: 'CapsLk',
    RUS: 'CapsLk',
    code: 'CapsLock',
  },
  {
    ENG: 'a',
    RUS: 'ф',
    code: 'KeyA',
  },
  {
    ENG: 's',
    RUS: 'ы',
    code: 'KeyS',
  },
  {
    ENG: 'd',
    RUS: 'в',
    code: 'KeyD',
  },
  {
    ENG: 'f',
    RUS: 'а',
    code: 'KeyF',
  },
  {
    ENG: 'g',
    RUS: 'п',
    code: 'KeyG',
  },
  {
    ENG: 'h',
    RUS: 'р',
    code: 'KeyH',
  },
  {
    ENG: 'j',
    RUS: 'о',
    code: 'KeyJ',
  },
  {
    ENG: 'k',
    RUS: 'л',
    code: 'KeyK',
  },
  {
    ENG: 'l',
    RUS: 'д',
    code: 'KeyL',
  },
  {
    ENG: ';',
    RUS: 'ж',
    code: 'Semicolon',
  },
  {
    ENG: "'",
    RUS: 'э',
    code: 'Quote',
  },
  {
    ENG: 'Enter',
    RUS: 'Enter',
    code: 'Enter',
  }],
[
  {
    ENG: 'Shift',
    RUS: 'Shift',
    code: 'ShiftLeft',
  },
  {
    ENG: 'z',
    RUS: 'я',
    code: 'KeyZ',
  },
  {
    ENG: 'x',
    RUS: 'ч',
    code: 'KeyX',
  },
  {
    ENG: 'c',
    RUS: 'с',
    code: 'KeyC',
  },
  {
    ENG: 'v',
    RUS: 'м',
    code: 'KeyV',
  },
  {
    ENG: 'b',
    RUS: 'и',
    code: 'KeyB',
  },
  {
    ENG: 'n',
    RUS: 'т',
    code: 'KeyN',
  },
  {
    ENG: 'm',
    RUS: 'ь',
    code: 'KeyM',
  },
  {
    ENG: ',',
    RUS: 'б',
    code: 'Comma',
  },
  {
    ENG: '.',
    RUS: 'ю',
    code: 'Period',
  },
  {
    ENG: '/',
    RUS: '.',
    code: 'Slash',
  },
  {
    ENG: '&#8593',
    RUS: '&#8593',
    code: 'ArrowUp',
  },
  {
    ENG: 'Shift',
    RUS: 'Shift',
    code: 'ShiftRight',
  }],
[
  {
    ENG: 'Ctrl',
    RUS: 'Ctrl',
    code: 'ControlLeft',
  },
  {
    ENG: 'Win',
    RUS: 'Win',
    code: 'MetaLeft',
  },
  {
    ENG: 'Alt',
    RUS: 'Alt',
    code: 'AltLeft',
  },
  {
    ENG: ' ',
    RUS: ' ',
    code: 'Space',
  },
  {
    ENG: 'Alt',
    RUS: 'Alt',
    code: 'AltRight',
  },
  {
    ENG: '&#8592',
    RUS: '&#8592',
    code: 'ArrowLeft',
  },
  {
    ENG: '&#8595',
    RUS: '&#8595',
    code: 'ArrowDown',
  },
  {
    ENG: '&#8594',
    RUS: '&#8594',
    code: 'ArrowRight',
  },
  {
    ENG: 'Ctrl',
    RUS: 'Ctrl',
    code: 'ControlRight',
  }],
];

const BODY = document.querySelector('body');

function createTitle() {
  const TITLE = document.createElement('div');
  TITLE.className = 'title';
  TITLE.innerHTML = 'RSS Виртуальная клавиатура';
  BODY.append(TITLE);
}
function createTextArea() {
  const TEXTAREA = document.createElement('textarea');
  TEXTAREA.className = 'text-area';
  TEXTAREA.cols = '60';
  TEXTAREA.rows = '8';
  BODY.append(TEXTAREA);
}
function createKeyboard() {
  const WRAPPER = document.createElement('div');
  WRAPPER.className = 'wrapper';
  BODY.append(WRAPPER);
  for (let i = 0; i < keysArr.length; i += 1) {
    const LINE = document.createElement('div');
    LINE.className = 'line';
    WRAPPER.append(LINE);
    for (let l = 0; l < keysArr[i].length; l += 1) {
      const KEY = document.createElement('div');
      KEY.className = `key letter ${keysArr[i][l].code}`;
      KEY.innerHTML = keysArr[i][l].ENG;
      LINE.append(KEY);
    }
  }
  const nonLetterKeys = document.querySelectorAll('.Backspace, .Tab, .CapsLock, .Enter, .ShiftLeft, .ShiftRight, .ControlLeft, .MetaLeft, .AltLeft, .AltRight, .ControlRight');
  nonLetterKeys.forEach((Element) => { Element.classList.remove('letter'); });
}
function projectDescription() {
  const DESCRIPTION = document.createElement('div');
  DESCRIPTION.innerHTML = 'Клавиатура создана в операционной системе Windows. <br> Для переключения языка комбинация: Left ALT + Left Shift(Здравствуйте! Не успел закончить, перепроверьте пожалуйста в четверг вечером(оставьте дискорд для связи, напишу по готовности). Спасибо! Хорошего вам дня!)';
  BODY.append(DESCRIPTION);
}
function createBody() {
  createTitle();
  createTextArea();
  createKeyboard();
  projectDescription();
}
createBody();

const TEXTAREA = document.querySelector('.text-area');
const LETTER = document.querySelectorAll('.letter');
const TABKEY = document.querySelector('.Tab');
const BACKSPACE = document.querySelector('.Backspace');
const CAPS = document.querySelector('.CapsLock');
const ENTERBTN = document.querySelector('.Enter');
const KEY = document.querySelectorAll('.key');

function enterLetters(event) {
  TEXTAREA.value += event.target.innerHTML;
  TEXTAREA.focus();
}
LETTER.forEach((Element) => { Element.addEventListener('click', enterLetters); });

function clickAnimationStart(event) {
  event.target.classList.add('animation');
}
function clickAnimationEnd(event) {
  event.target.classList.remove('animation');
}

KEY.forEach((Element) => {
  Element.addEventListener('mousedown', clickAnimationStart);
  Element.addEventListener('mouseout', clickAnimationEnd);
  Element.addEventListener('mouseup', clickAnimationEnd);
});
function keyboardAnimationStart(event) {
  if (event.code !== 'F12') {
    TEXTAREA.focus();
    const BUTTONPRESSED = document.querySelector(`.${event.code}`);
    BUTTONPRESSED.classList.add('animation');
  }
}
function keyboardAnimationEnd(event) {
  if (event.code !== 'F12') {
    const BUTTONPRESSED = document.querySelector(`.${event.code}`);
    BUTTONPRESSED.classList.remove('animation');
  }
}

document.addEventListener('keydown', keyboardAnimationStart);
document.addEventListener('keyup', keyboardAnimationEnd);

function tabBtn(event) {
  if (event.code === 'Tab' || event.target.classList.contains('Tab')) {
    TEXTAREA.focus();
    event.preventDefault();
    TEXTAREA.value = `${TEXTAREA.value}\t`;
  }
}

document.addEventListener('keydown', tabBtn);
TABKEY.addEventListener('click', tabBtn);

function capsLockBtn(event) {
  if ((event.code === 'CapsLock' && CAPS.classList.contains('caps-active')) || (event.target.classList.contains('caps-active'))) {
    CAPS.classList.remove('caps-active');
    LETTER.forEach((letters) => {
      const letter = letters;
      letter.innerHTML = letter.innerHTML.toLowerCase();
    });
  } else if (event.code === 'CapsLock' || event.target.classList.contains('CapsLock')) {
    CAPS.classList.add('caps-active');
    LETTER.forEach((letters) => {
      const letter = letters;
      letter.innerHTML = letter.innerHTML.toUpperCase();
    });
  }
}

CAPS.addEventListener('click', capsLockBtn);
document.addEventListener('keydown', capsLockBtn);

function backSpaceBtn() {
  const textValue = TEXTAREA.value;
  TEXTAREA.value = textValue.slice(0, -1);
}
BACKSPACE.addEventListener('click', backSpaceBtn);

function enterBtn() {
  TEXTAREA.focus();
  TEXTAREA.value = `${TEXTAREA.value}\n`;
}
ENTERBTN.addEventListener('click', enterBtn);

let currentLang = 'ENG';
function langSwitch(event) {
  if (currentLang === 'ENG') {
    if (event.code === 'AltLeft') {
      document.onkeyup = function isShift(press) {
        if (press.code === 'ShiftLeft') {
          currentLang = 'RUS';
          KEY.forEach((buttons) => {
            const button = buttons;
            for (let i = 0; i < keysArr.length; i += 1) {
              for (let l = 0; l < keysArr[i].length; l += 1) {
                if (button.classList.contains(`${keysArr[i][l].code}`)) {
                  button.innerHTML = `${keysArr[i][l].RUS}`;
                }
              }
            }
          });
        }
      };
    }
  } else if (event.code === 'AltLeft') {
    document.onkeyup = function isShift(press) {
      if (press.code === 'ShiftLeft') {
        currentLang = 'ENG';
        KEY.forEach((buttons) => {
          const button = buttons;
          for (let i = 0; i < keysArr.length; i += 1) {
            for (let l = 0; l < keysArr[i].length; l += 1) {
              if (button.classList.contains(`${keysArr[i][l].code}`)) {
                button.innerHTML = `${keysArr[i][l].ENG}`;
              }
            }
          }
        });
      }
    };
  }
}
document.addEventListener('keydown', langSwitch);
